version: "3"
services:
    mongodb:
        image: mongo
        ports:
            - "27017:27017"
        volumes:
            - "todo-app-data:/data/db"
            - "todo-app-config-data:/data/config"

    todo-api:
        build:
            context: ../todo-api-java
        image: todo-api
        ports:
            - "8080:8080"
        environment:
            MONGODB_URL: mongodb:27017
            SPRING_LOG_LEVEL: INFO
            APP_LOG_LEVEL: DEBUG
#            ALLOWED_ORIGINS: '*'
            AZURE_APP_ID: 'ADD APP ID HERE'
            AD_IDENTITY_META_DATA_URL: https://login.microsoftonline.com/architech.onmicrosoft.com/v2.0/.well-known/openid-configuration=
        depends_on:
            - mongodb
volumes:
    todo-app-data:
        # external: true
    todo-app-config-data:
        # external: true
